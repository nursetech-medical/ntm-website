<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cordflex ROI Calculator - Nursetech Medical</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f8fafc;
            min-height: 100vh;
            padding: 20px;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #214140 0%, #2c5d5c 100%);
            color: white;
            text-align: center;
            padding: 40px 20px;
            position: relative;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 30px;
            flex-wrap: wrap;
            max-width: 1100px;
            margin: 0 auto;
        }

        .title-section {
            flex: 1;
            min-width: 280px;
            text-align: left;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 8px;
            font-weight: 700;
        }

        .header p {
            font-size: 1rem;
            opacity: 0.95;
        }

        .print-button {
            background: rgba(255, 255, 255, 0.15);
            border: 2px solid white;
            color: white;
            padding: 12px 28px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .print-button:hover {
            background: white;
            color: #214140;
            transform: translateY(-2px);
        }

        .main-content {
            padding: 30px;
        }

        .input-section {
            background: #DFEAF0;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            border-left: 5px solid #214140;
        }

        .input-section h3 {
            color: #214140;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .input-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #214140;
            font-size: 0.95rem;
        }

        .input-group input, .input-group select {
            padding: 12px 15px;
            border: 2px solid #8BBAB8;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
            background: white;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #214140;
            box-shadow: 0 0 0 3px rgba(33, 65, 64, 0.1);
        }

        .results-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .result-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            border-left: 5px solid #8BBAB8;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .result-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }

        .result-card h3 {
            color: #214140;
            margin-bottom: 12px;
            font-size: 1.2rem;
        }

        .result-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #1F8051;
            margin-bottom: 8px;
        }

        .result-description {
            color: #718096;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .result-description strong {
            color: #214140;
        }

        .details-section {
            background: #f7fafc;
            padding: 30px;
            border-radius: 12px;
            margin-top: 30px;
        }

        .details-section > h3 {
            color: #214140;
            margin-bottom: 25px;
            font-size: 1.5rem;
            border-bottom: 3px solid #8BBAB8;
            padding-bottom: 12px;
        }

        .category-section {
            margin-bottom: 35px;
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border: 1px solid #e2e8f0;
        }

        .category-title {
            font-size: 1.15rem;
            font-weight: 600;
            color: #214140;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #DFEAF0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .category-title-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .category-title-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .category-title input[type="checkbox"] {
            cursor: pointer;
            width: 18px;
            height: 18px;
        }

        .expand-hint {
            font-size: 0.7rem;
            color: #a0aec0;
            font-weight: 400;
            font-style: italic;
            white-space: nowrap;
        }

        .toggle-arrow {
            cursor: pointer;
            font-size: 1.3rem;
            user-select: none;
            color: #8BBAB8;
            transition: transform 0.3s;
            padding: 5px 10px;
        }

        .toggle-arrow:hover {
            color: #214140;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            font-size: 0.9rem;
            table-layout: auto;
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .data-table th {
            background-color: #DFEAF0;
            font-weight: 600;
            color: #214140;
        }

        .data-table .metric-cell {
            font-weight: 500;
            color: #2d3748;
        }

        .data-table .value-cell {
            font-weight: 600;
            color: #214140;
        }

        .data-table .reference-cell {
            font-size: 0.8rem;
            color: #718096;
            font-style: italic;
        }

        .editable-input {
            background-color: #fff3cd;
            border: 2px solid #ffc107;
            padding: 8px;
            border-radius: 6px;
            width: 100%;
            min-width: 100px;
            max-width: 140px;
            font-size: 0.9rem;
        }

        .editable-input:focus {
            background-color: #ffffff;
            border-color: #214140;
            outline: none;
        }

        .calculation-steps {
            background: #f0f9ff;
            padding: 18px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #8BBAB8;
        }

        .calculation-steps h4 {
            color: #214140;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .calculation-steps p {
            font-size: 0.9rem;
            color: #4a5568;
            margin-bottom: 5px;
        }

        .savings-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .savings-table th,
        .savings-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .savings-table th {
            background-color: #214140;
            color: white;
            font-weight: 600;
        }

        .savings-table .savings-min {
            font-weight: 700;
            color: #2d5016;
            font-size: 1.1rem;
        }

        .savings-table .savings-max {
            font-weight: 700;
            color: #22543d;
            font-size: 1.1rem;
        }

        .roi-summary {
            background: linear-gradient(135deg, #1F8051 0%, #2d9c66 100%);
            color: white;
            padding: 35px;
            border-radius: 12px;
            text-align: center;
            margin-top: 30px;
        }

        .roi-summary h2 {
            font-size: 2rem;
            margin-bottom: 15px;
        }

        .roi-range {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            font-size: 1.1rem;
            flex-wrap: wrap;
            gap: 20px;
        }

        .roi-range > div {
            flex: 1;
            min-width: 200px;
        }

        .roi-value {
            font-size: 2.2rem;
            font-weight: 700;
            margin: 10px 0;
        }

        .references-section {
            background: #f7fafc;
            padding: 25px;
            border-radius: 12px;
            margin-top: 30px;
        }

        .references-section h3 {
            color: #214140;
            margin-bottom: 20px;
            font-size: 1.4rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            border-bottom: 3px solid #8BBAB8;
            padding-bottom: 12px;
        }

        .references-list {
            font-size: 0.85rem;
            line-height: 1.8;
            color: #4a5568;
        }

        .references-list ol {
            padding-left: 20px;
        }

        .references-list li {
            margin-bottom: 12px;
        }

        .hidden {
            display: none;
        }

        @media print {
            .print-button, .toggle-arrow {
                display: none !important;
            }

            body {
                background: white !important;
                font-size: 11px;
            }

            .container {
                box-shadow: none;
                border-radius: 0;
            }

            .header {
                background: #214140 !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            .hidden {
                display: block !important;
            }

            .category-section {
                page-break-inside: avoid;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.5rem;
            }

            .header-content {
                flex-direction: column;
                text-align: center;
            }

            .title-section {
                text-align: center;
            }

            .input-row {
                grid-template-columns: 1fr;
            }

            .results-section {
                grid-template-columns: 1fr;
            }

            .main-content {
                padding: 20px;
            }

            .input-section {
                padding: 20px;
            }

            .data-table {
                font-size: 0.8rem;
            }

            .data-table th,
            .data-table td {
                padding: 8px 6px;
            }

            .editable-input {
                max-width: 100px;
                min-width: 80px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="title-section">
                    <h1>Cordflex ROI Calculator</h1>
                    <p>Calculate the Return on Investment for Cordflex Cord Management System</p>
                </div>
                <button class="print-button" onclick="printPage()">üñ®Ô∏è Print Report</button>
            </div>
        </div>

        <div class="main-content">
            <div class="input-section">
                <h3>Hospital Configuration</h3>

                <div class="input-row">
                    <div class="input-group">
                        <label for="hospitalState">Hospital State</label>
                        <select id="hospitalState">
                            <option value="AL">Alabama</option>
                            <option value="AK">Alaska</option>
                            <option value="AZ">Arizona</option>
                            <option value="AR">Arkansas</option>
                            <option value="CA">California</option>
                            <option value="CO">Colorado</option>
                            <option value="CT">Connecticut</option>
                            <option value="DE">Delaware</option>
                            <option value="FL">Florida</option>
                            <option value="GA">Georgia</option>
                            <option value="HI">Hawaii</option>
                            <option value="ID">Idaho</option>
                            <option value="IL">Illinois</option>
                            <option value="IN">Indiana</option>
                            <option value="IA">Iowa</option>
                            <option value="KS">Kansas</option>
                            <option value="KY">Kentucky</option>
                            <option value="LA">Louisiana</option>
                            <option value="ME">Maine</option>
                            <option value="MD" selected>Maryland</option>
                            <option value="MA">Massachusetts</option>
                            <option value="MI">Michigan</option>
                            <option value="MN">Minnesota</option>
                            <option value="MS">Mississippi</option>
                            <option value="MO">Missouri</option>
                            <option value="MT">Montana</option>
                            <option value="NE">Nebraska</option>
                            <option value="NV">Nevada</option>
                            <option value="NH">New Hampshire</option>
                            <option value="NJ">New Jersey</option>
                            <option value="NM">New Mexico</option>
                            <option value="NY">New York</option>
                            <option value="NC">North Carolina</option>
                            <option value="ND">North Dakota</option>
                            <option value="OH">Ohio</option>
                            <option value="OK">Oklahoma</option>
                            <option value="OR">Oregon</option>
                            <option value="PA">Pennsylvania</option>
                            <option value="RI">Rhode Island</option>
                            <option value="SC">South Carolina</option>
                            <option value="SD">South Dakota</option>
                            <option value="TN">Tennessee</option>
                            <option value="TX">Texas</option>
                            <option value="UT">Utah</option>
                            <option value="VT">Vermont</option>
                            <option value="VA">Virginia</option>
                            <option value="WA">Washington</option>
                            <option value="WV">West Virginia</option>
                            <option value="WI">Wisconsin</option>
                            <option value="WY">Wyoming</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="icuType">ICU Type</label>
                        <select id="icuType">
                            <option value="general">General ICU</option>
                            <option value="medical">Medical ICU (MICU)</option>
                            <option value="surgical">Surgical ICU (SICU)</option>
                            <option value="cardiac">Cardiac ICU (CICU)</option>
                            <option value="neurological">Neurological ICU (NICU)</option>
                            <option value="trauma">Trauma ICU</option>
                            <option value="pediatric">Pediatric ICU (PICU)</option>
                            <option value="neonatal">Neonatal ICU (NICU)</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="icuBeds">Number of ICU Beds</label>
                        <input type="number" id="icuBeds" value="20" min="1" max="200">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label for="occupancyRate">Average Occupancy Rate (%)</label>
                        <input type="number" id="occupancyRate" value="72" min="0" max="100">
                    </div>
                    <div class="input-group">
                        <label for="avgStay">Average Patient Stay (days)</label>
                        <input type="number" id="avgStay" value="4.4" min="0.5" step="0.1">
                    </div>
                    <div class="input-group">
                        <label for="clipsPerPatient">Clips per Patient</label>
                        <input type="number" id="clipsPerPatient" value="1.5" min="0.1" max="10" step="0.1">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label for="clipPrice">Cordflex Clip Price ($)</label>
                        <input type="number" id="clipPrice" value="15.00" min="0" step="0.01">
                    </div>
                </div>
            </div>

            <div class="results-section">
                <div class="result-card">
                    <h3>Annual Implementation Cost</h3>
                    <div class="result-value">$<span id="annualCost">26,865.00</span></div>
                    <div class="result-description">
                        Total yearly cost for Cordflex clips based on your configuration<br>
                        <strong><span id="budgetPercentage">0.08%</span> of total ICU revenue</strong>
                    </div>
                </div>

                <div class="result-card">
                    <h3>Annual Savings Range</h3>
                    <div class="result-value">$<span id="annualSavingsMin">108,000</span> - $<span id="annualSavingsMax">211,500</span></div>
                    <div class="result-description">Total projected savings from reduced incidents and time efficiency</div>
                </div>
            </div>

            <div class="details-section">
                <h3>Detailed Financial Analysis</h3>

                <!-- Medical Errors Section -->
                <div class="category-section">
                    <div class="category-title">
                        <div class="category-title-left">
                            <input type="checkbox" id="includeErrors" checked>
                            <span>Medical Error Reduction</span>
                        </div>
                        <div class="category-title-right">
                            <span class="expand-hint">click arrow to edit values</span>
                            <span class="toggle-arrow" onclick="toggleSection('errorDetails')">‚ñº</span>
                        </div>
                    </div>

                    <div id="errorDetails" class="hidden">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Metric</th>
                                    <th>Min Value</th>
                                    <th>Max Value</th>
                                    <th>Reference</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="metric-cell">Cost per medical error incident ($)</td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="errorCostMin" value="4000" step="100"></td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="errorCostMax" value="10000" step="100"></td>
                                    <td class="reference-cell">Hug et al., 2012 [10]</td>
                                </tr>
                                <tr>
                                    <td class="metric-cell">Reduction in medication errors (%)</td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="errorReductionMin" value="7" step="1" min="0" max="100"></td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="errorReductionMax" value="8" step="1" min="0" max="100"></td>
                                    <td class="reference-cell">Goodin et al., 2012; Pinkney et al., 2019 [12,13]</td>
                                </tr>
                                <tr>
                                    <td class="metric-cell">Preventable errors per ICU bed per year</td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="errorsPerBedMin" value="0.8" step="0.1" min="0"></td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="errorsPerBedMax" value="1.2" step="0.1" min="0"></td>
                                    <td class="reference-cell">PA Patient Safety Advisory, 2014 [8,11]</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="calculation-steps">
                            <h4>Key Calculation Steps:</h4>
                            <p>‚Ä¢ Annual errors per ICU = ICU beds √ó errors per bed per year</p>
                            <p>‚Ä¢ Preventable errors = Annual errors √ó reduction percentage</p>
                            <p>‚Ä¢ Savings = Preventable errors √ó cost per error</p>
                        </div>
                    </div>

                    <table class="savings-table">
                        <thead>
                            <tr>
                                <th>Calculation Component</th>
                                <th>Min Savings</th>
                                <th>Max Savings</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Annual medical error savings</td>
                                <td class="savings-min">$<span id="errorSavingsMin">8,000</span></td>
                                <td class="savings-max">$<span id="errorSavingsMax">18,000</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Line Pullouts Section -->
                <div class="category-section">
                    <div class="category-title">
                        <div class="category-title-left">
                            <input type="checkbox" id="includePullouts" checked>
                            <span>Line Pullout Prevention</span>
                        </div>
                        <div class="category-title-right">
                            <span class="expand-hint">click arrow to edit values</span>
                            <span class="toggle-arrow" onclick="toggleSection('pulloutDetails')">‚ñº</span>
                        </div>
                    </div>

                    <div id="pulloutDetails" class="hidden">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Metric</th>
                                    <th>Min Value</th>
                                    <th>Max Value</th>
                                    <th>Reference</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="metric-cell">Cost per line pullout incident ($)</td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="pulloutCostMin" value="250" step="25"></td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="pulloutCostMax" value="500" step="25"></td>
                                    <td class="reference-cell">Moureau et al., 2018 [6,7]</td>
                                </tr>
                                <tr>
                                    <td class="metric-cell">Pullouts per ICU bed per month</td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="pulloutsPerBedMin" value="0.4" step="0.1" min="0"></td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="pulloutsPerBedMax" value="0.6" step="0.1" min="0"></td>
                                    <td class="reference-cell">Hospital incident reports; 19M annual events nationwide [7]</td>
                                </tr>
                                <tr>
                                    <td class="metric-cell">Reduction with Cordflex (%)</td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="pulloutReductionMin" value="30" step="5" min="0" max="100"></td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="pulloutReductionMax" value="50" step="5" min="0" max="100"></td>
                                    <td class="reference-cell">Cordflex pilot studies</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="calculation-steps">
                            <h4>Key Calculation Steps:</h4>
                            <p>‚Ä¢ Annual pullouts per ICU = ICU beds √ó pullouts per bed per month √ó 12</p>
                            <p>‚Ä¢ Prevented pullouts = Annual pullouts √ó reduction percentage</p>
                            <p>‚Ä¢ Savings = Prevented pullouts √ó cost per pullout</p>
                        </div>
                    </div>

                    <table class="savings-table">
                        <thead>
                            <tr>
                                <th>Calculation Component</th>
                                <th>Min Savings</th>
                                <th>Max Savings</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Annual line pullout savings</td>
                                <td class="savings-min">$<span id="pulloutSavingsMin">7,200</span></td>
                                <td class="savings-max">$<span id="pulloutSavingsMax">36,000</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Fall Prevention Section -->
                <div class="category-section">
                    <div class="category-title">
                        <div class="category-title-left">
                            <input type="checkbox" id="includeFalls" checked>
                            <span>Fall Prevention</span>
                        </div>
                        <div class="category-title-right">
                            <span class="expand-hint">click arrow to edit values</span>
                            <span class="toggle-arrow" onclick="toggleSection('fallDetails')">‚ñº</span>
                        </div>
                    </div>

                    <div id="fallDetails" class="hidden">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Metric</th>
                                    <th>Min Value</th>
                                    <th>Max Value</th>
                                    <th>Reference</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="metric-cell">Average cost per fall with injury ($)</td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="fallCostMin" value="35365" step="500"></td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="fallCostMax" value="36776" step="500"></td>
                                    <td class="reference-cell">Dykes et al., 2020; AHRQ [2,4]</td>
                                </tr>
                                <tr>
                                    <td class="metric-cell">Average Falls per ICU per year</td>
                                    <td class="value-cell"><span id="fallsPerYearMin" style="font-weight: 600; color: #214140;">7.1</span></td>
                                    <td class="value-cell"><span id="fallsPerYearMax" style="font-weight: 600; color: #214140;">48.7</span></td>
                                    <td class="reference-cell">Calculated from 1.3-8.9 falls per 1,000 bed-days; based on occupied beds [4]</td>
                                </tr>
                                <tr>
                                    <td class="metric-cell">Preventing # Falls with Cordflex</td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="fallsPreventedMin" value="1" step="1" min="0"></td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="fallsPreventedMax" value="1" step="1" min="0"></td>
                                    <td class="reference-cell">Estimated; reduced line entanglements [3]</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="calculation-steps">
                            <h4>Key Calculation Steps:</h4>
                            <p>‚Ä¢ Occupied beds = ICU beds √ó occupancy rate</p>
                            <p>‚Ä¢ Bed-days per year = occupied beds √ó 365</p>
                            <p>‚Ä¢ Falls per year = (bed-days √∑ 1,000) √ó fall rate (1.3-8.9 per 1,000 bed-days)</p>
                            <p>‚Ä¢ Savings = Falls prevented √ó cost per fall</p>
                        </div>
                    </div>

                    <table class="savings-table">
                        <thead>
                            <tr>
                                <th>Calculation Component</th>
                                <th>Min Savings</th>
                                <th>Max Savings</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Annual fall prevention savings</td>
                                <td class="savings-min">$<span id="fallSavingsMin">35,365</span></td>
                                <td class="savings-max">$<span id="fallSavingsMax">36,776</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Nurse Time Savings Section -->
                <div class="category-section">
                    <div class="category-title">
                        <div class="category-title-left">
                            <input type="checkbox" id="includeTime" checked>
                            <span>Nurse Time Savings</span>
                        </div>
                        <div class="category-title-right">
                            <span class="expand-hint">click arrow to edit values</span>
                            <span class="toggle-arrow" onclick="toggleSection('timeDetails')">‚ñº</span>
                        </div>
                    </div>

                    <div id="timeDetails" class="hidden">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Metric</th>
                                    <th>Min Value</th>
                                    <th>Max Value</th>
                                    <th>Reference</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="metric-cell">Time spent managing lines per patient (min)</td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="timePerPatientMin" value="15" step="1" min="1"></td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="timePerPatientMax" value="20" step="1" min="1"></td>
                                    <td class="reference-cell">Benjamin et al., 2022; 61.4% of mobility time (4.7 min average) [1]</td>
                                </tr>
                                <tr>
                                    <td class="metric-cell">Time reduction with Cordflex (%)</td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="timeReductionMin" value="36" step="1" min="0" max="100"></td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="timeReductionMax" value="37" step="1" min="0" max="100"></td>
                                    <td class="reference-cell">Nurse survey data; Cordflex pilot studies</td>
                                </tr>
                                <tr>
                                    <td class="metric-cell">Average nurse hourly wage ($)</td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="nurseWageMin" value="35" step="1"></td>
                                    <td class="value-cell"><input type="number" class="editable-input" id="nurseWageMax" value="50" step="1"></td>
                                    <td class="reference-cell">Bureau of Labor Statistics; regional salary data</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="calculation-steps">
                            <h4>Key Calculation Steps:</h4>
                            <p>‚Ä¢ Time per nurse per shift = time per patient √ó 2 (1:2 nurse-to-patient ratio)</p>
                            <p>‚Ä¢ Total nurse shifts per year = (ICU beds √∑ 2) √ó 365 days √ó 2 shifts</p>
                            <p>‚Ä¢ Time saved per year = Total nurse shifts √ó time per nurse per shift √ó reduction % √∑ 60 (hours)</p>
                            <p>‚Ä¢ Value = Time saved hours √ó nurse hourly wage</p>
                        </div>
                    </div>

                    <table class="savings-table">
                        <thead>
                            <tr>
                                <th>Calculation Component</th>
                                <th>Min Savings</th>
                                <th>Max Savings</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Annual nurse time savings</td>
                                <td class="savings-min">$<span id="timeSavingsMin">67,600</span></td>
                                <td class="savings-max">$<span id="timeSavingsMax">162,500</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="roi-summary">
                <h2>ROI Summary</h2>
                <div class="roi-range">
                    <div>
                        <strong>Min ROI:</strong>
                        <div class="roi-value"><span id="roiMin">242</span>%</div>
                    </div>
                    <div>
                        <strong>Max ROI:</strong>
                        <div class="roi-value"><span id="roiMax">570</span>%</div>
                    </div>
                </div>
                <p>Return on Investment Range</p>
                <div style="margin-top: 20px; font-size: 1.05rem;">
                    <strong>Net Annual Savings: $<span id="netSavingsMin">76,464</span> - $<span id="netSavingsMax">179,964</span></strong><br>
                    <strong>Implementation Cost: <span id="budgetPercentageROI">0.08%</span> of ICU Budget</strong>
                </div>
            </div>

            <!-- References Section -->
            <div class="references-section">
                <h3 onclick="toggleSection('referencesList')">
                    <span>References</span>
                    <span class="toggle-arrow">‚ñº</span>
                </h3>
                <div id="referencesList" class="references-list hidden">
                    <ol>
                        <li>Benjamin E, Roddy L, Giuliano KK. Management of patient tubes and lines during early mobility in the ICU. Human Factors in Healthcare. 2022;2:100017.</li>
                        <li>Dykes PC, Burns Z, Adelman J, et al. Economic Evaluation of a Patient-Centered Fall-Prevention Tool Kit. JAMA Netw Open. 2020;3(11):e2025889.</li>
                        <li>Dressner MA, Kissinger SP. Occupational injuries and illnesses among registered nurses. Mon Labor Rev. 2018;141(11):1-15.</li>
                        <li>Falls. PSNet [Internet]. Rockville (MD): Agency for Healthcare Research and Quality, US Department of Health and Human Services; 2019 [updated 2024].</li>
                        <li>The Joint Commission. National Patient Safety Goals¬Æ Effective January 2024 for the Hospital Program. Oakbrook Terrace, IL: The Joint Commission; 2024.</li>
                        <li>Moureau N, Marsh N, Ullman AJ, et al. Impact and safety associated with accidental dislodgement of vascular access devices: a survey of professions, settings, and devices. J Vasc Access. 2018;19(4):203-215.</li>
                        <li>Moureau N. Impact and safety associated with accidental dislodgement of Vascular Access Devices. J Assoc Vasc Access. 2018;23(4):203‚Äì215.</li>
                        <li>Pennsylvania Patient Safety Advisory. Aligning the Lines: An Analysis of IV Line Errors. Pa Patient Saf Advis. 2014;11(1):1-8.</li>
                        <li>Subhan A. Revised Joint Commission standards for medical equipment. 24x7 Magazine. Published online October 2014.</li>
                        <li>Hug BL, Keohane C, Seger DL, Yoon C, Bates DW. The costs of adverse drug events in community hospitals. Jt Comm J Qual Patient Saf. 2012;38(3):120-126.</li>
                        <li>Pennsylvania Patient Safety Advisory. Aligning the Lines: An Analysis of IV Line Errors. Pa Patient Saf Advis. 2014;11(1):1-8.</li>
                        <li>Goodin HJ, Ryan-Wenger NA, Mullet J. Pediatric medical line safety. J Pediatr Nurs. 2012;27(6):725-733.</li>
                        <li>Pinkney SJ, Fan M, Koczmara C, Trbovich PL. Untangling infusion confusion. Crit Care Med. 2019;47(7):e597‚Äìe601.</li>
                        <li>ECRI. Patient Safety Solutions and Services. ECRI website. Accessed January 27, 2025.</li>
                        <li>Lord RK, Mayhew CR, Korupolu R, et al. ICU early physical rehabilitation programs: financial modeling of cost savings. Crit Care Med. 2013;41(3):717-724.</li>
                        <li>Parker A, Sricharoenchai T, Needham DM. Early Rehabilitation in the Intensive Care Unit: Preventing Physical and Mental Health Impairments. Curr Phys Med Rehabil Rep. 2013;1(4):307-314.</li>
                        <li>Nurse-Driven Early Mobility Protocols: Facilitator Guide. Agency for Healthcare Research and Quality website. Updated March 2017.</li>
                        <li>Schweickert WD, Pohlman MC, Pohlman AS, et al. Early physical and occupational therapy in mechanically ventilated, critically ill patients: a randomised controlled trial. Lancet. 2009;373(9678):1874-1882.</li>
                        <li>NSI Nursing Solutions, Inc. 2025 NSI National Health Care Retention & RN Staffing Report. NSI Nursing Solutions, Inc.; March 2025.</li>
                        <li>AMN Healthcare. 2023 Survey of Registered Nurses. AMN Healthcare; May 2023.</li>
                        <li>Xu W, Wang B, Chen L, et al. Global prevalence of turnover intention among intensive care nurses: A meta-analysis. Nurs Crit Care. 2022;27(4):578-585.</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <script>
        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            const arrow = event.target.closest('.toggle-arrow') || event.target;

            if (section.classList.contains('hidden')) {
                section.classList.remove('hidden');
                if (arrow.classList && arrow.classList.contains('toggle-arrow')) {
                    arrow.textContent = '‚ñ≤';
                }
            } else {
                section.classList.add('hidden');
                if (arrow.classList && arrow.classList.contains('toggle-arrow')) {
                    arrow.textContent = '‚ñº';
                }
            }
        }

        function printPage() {
            const hiddenSections = document.querySelectorAll('.hidden');
            hiddenSections.forEach(section => section.classList.remove('hidden'));

            setTimeout(() => {
                window.print();
                setTimeout(() => {
                    hiddenSections.forEach(section => section.classList.add('hidden'));
                }, 1000);
            }, 200);
        }

        function formatNumber(num) {
            return Math.round(num).toLocaleString('en-US');
        }

        function calculateROI() {
            const icuBeds = parseInt(document.getElementById('icuBeds').value) || 20;
            const occupancyRate = parseFloat(document.getElementById('occupancyRate').value) / 100 || 0.72;
            const avgStay = parseFloat(document.getElementById('avgStay').value) || 4.4;
            const clipsPerPatient = parseFloat(document.getElementById('clipsPerPatient').value) || 1.5;
            const clipPrice = parseFloat(document.getElementById('clipPrice').value) || 15.00;

            // Calculate annual cost
            const effectiveBeds = icuBeds * occupancyRate;
            const patientsPerYear = (effectiveBeds / avgStay) * 365;
            const clipsPerYear = patientsPerYear * clipsPerPatient;
            const annualCost = clipsPerYear * clipPrice;

            // Calculate budget percentage (based on $35M ICU revenue)
            const totalICURevenue = 35000000;
            const budgetPercentage = (annualCost / totalICURevenue) * 100;

            // Calculate falls per year for display
            const bedDaysPerYear = effectiveBeds * 365;
            const fallsPerYearMin = (bedDaysPerYear / 1000) * 1.3;
            const fallsPerYearMax = (bedDaysPerYear / 1000) * 8.9;

            document.getElementById('fallsPerYearMin').textContent = fallsPerYearMin.toFixed(1);
            document.getElementById('fallsPerYearMax').textContent = fallsPerYearMax.toFixed(1);

            // Calculate savings by category
            let errorSavingsMin = 0, errorSavingsMax = 0;
            if (document.getElementById('includeErrors').checked) {
                const errorCostMin = parseFloat(document.getElementById('errorCostMin').value) || 4000;
                const errorCostMax = parseFloat(document.getElementById('errorCostMax').value) || 10000;
                const errorReductionMin = parseFloat(document.getElementById('errorReductionMin').value) / 100 || 0.07;
                const errorReductionMax = parseFloat(document.getElementById('errorReductionMax').value) / 100 || 0.08;
                const errorsPerBedMin = parseFloat(document.getElementById('errorsPerBedMin').value) || 0.8;
                const errorsPerBedMax = parseFloat(document.getElementById('errorsPerBedMax').value) || 1.2;

                errorSavingsMin = icuBeds * errorsPerBedMin * errorCostMin * errorReductionMin;
                errorSavingsMax = icuBeds * errorsPerBedMax * errorCostMax * errorReductionMax;
            }

            let pulloutSavingsMin = 0, pulloutSavingsMax = 0;
            if (document.getElementById('includePullouts').checked) {
                const pulloutCostMin = parseFloat(document.getElementById('pulloutCostMin').value) || 250;
                const pulloutCostMax = parseFloat(document.getElementById('pulloutCostMax').value) || 500;
                const pulloutsPerBedMin = parseFloat(document.getElementById('pulloutsPerBedMin').value) || 0.4;
                const pulloutsPerBedMax = parseFloat(document.getElementById('pulloutsPerBedMax').value) || 0.6;
                const pulloutReductionMin = parseFloat(document.getElementById('pulloutReductionMin').value) / 100 || 0.3;
                const pulloutReductionMax = parseFloat(document.getElementById('pulloutReductionMax').value) / 100 || 0.5;

                pulloutSavingsMin = icuBeds * pulloutsPerBedMin * 12 * pulloutCostMin * pulloutReductionMin;
                pulloutSavingsMax = icuBeds * pulloutsPerBedMax * 12 * pulloutCostMax * pulloutReductionMax;
            }

            let fallSavingsMin = 0, fallSavingsMax = 0;
            if (document.getElementById('includeFalls').checked) {
                const fallCostMin = parseFloat(document.getElementById('fallCostMin').value) || 35365;
                const fallCostMax = parseFloat(document.getElementById('fallCostMax').value) || 36776;
                const fallsPreventedMin = parseFloat(document.getElementById('fallsPreventedMin').value) || 1;
                const fallsPreventedMax = parseFloat(document.getElementById('fallsPreventedMax').value) || 1;

                fallSavingsMin = fallsPreventedMin * fallCostMin;
                fallSavingsMax = fallsPreventedMax * fallCostMax;
            }

            let timeSavingsMin = 0, timeSavingsMax = 0;
            if (document.getElementById('includeTime').checked) {
                const timePerPatientMin = parseFloat(document.getElementById('timePerPatientMin').value) || 15;
                const timePerPatientMax = parseFloat(document.getElementById('timePerPatientMax').value) || 20;
                const timeReductionMin = parseFloat(document.getElementById('timeReductionMin').value) / 100 || 0.36;
                const timeReductionMax = parseFloat(document.getElementById('timeReductionMax').value) / 100 || 0.37;
                const nurseWageMin = parseFloat(document.getElementById('nurseWageMin').value) || 35;
                const nurseWageMax = parseFloat(document.getElementById('nurseWageMax').value) || 50;

                const timePerNursePerShiftMin = timePerPatientMin * 2;
                const timePerNursePerShiftMax = timePerPatientMax * 2;

                const nursesPerDay = icuBeds / 2;
                const totalNurseShiftsPerYear = nursesPerDay * 365 * 2;

                const hoursPerYearMin = (totalNurseShiftsPerYear * timePerNursePerShiftMin * timeReductionMin) / 60;
                const hoursPerYearMax = (totalNurseShiftsPerYear * timePerNursePerShiftMax * timeReductionMax) / 60;

                timeSavingsMin = hoursPerYearMin * nurseWageMin;
                timeSavingsMax = hoursPerYearMax * nurseWageMax;
            }

            // Total savings
            const totalSavingsMin = errorSavingsMin + pulloutSavingsMin + fallSavingsMin + timeSavingsMin;
            const totalSavingsMax = errorSavingsMax + pulloutSavingsMax + fallSavingsMax + timeSavingsMax;

            // Calculate ROI
            const netSavingsMin = totalSavingsMin - annualCost;
            const netSavingsMax = totalSavingsMax - annualCost;
            const roiMin = annualCost > 0 ? (netSavingsMin / annualCost) * 100 : 0;
            const roiMax = annualCost > 0 ? (netSavingsMax / annualCost) * 100 : 0;

            // Update display
            document.getElementById('annualCost').textContent = formatNumber(annualCost);
            document.getElementById('budgetPercentage').textContent = budgetPercentage.toFixed(3) + '%';
            document.getElementById('budgetPercentageROI').textContent = budgetPercentage.toFixed(3) + '%';
            document.getElementById('annualSavingsMin').textContent = formatNumber(totalSavingsMin);
            document.getElementById('annualSavingsMax').textContent = formatNumber(totalSavingsMax);
            document.getElementById('roiMin').textContent = Math.round(roiMin);
            document.getElementById('roiMax').textContent = Math.round(roiMax);
            document.getElementById('netSavingsMin').textContent = formatNumber(netSavingsMin);
            document.getElementById('netSavingsMax').textContent = formatNumber(netSavingsMax);

            // Update category savings
            document.getElementById('errorSavingsMin').textContent = formatNumber(errorSavingsMin);
            document.getElementById('errorSavingsMax').textContent = formatNumber(errorSavingsMax);
            document.getElementById('pulloutSavingsMin').textContent = formatNumber(pulloutSavingsMin);
            document.getElementById('pulloutSavingsMax').textContent = formatNumber(pulloutSavingsMax);
            document.getElementById('fallSavingsMin').textContent = formatNumber(fallSavingsMin);
            document.getElementById('fallSavingsMax').textContent = formatNumber(fallSavingsMax);
            document.getElementById('timeSavingsMin').textContent = formatNumber(timeSavingsMin);
            document.getElementById('timeSavingsMax').textContent = formatNumber(timeSavingsMax);
        }

        // Add event listeners
        document.addEventListener('DOMContentLoaded', function() {
            const allInputs = document.querySelectorAll('input, select');

            allInputs.forEach(input => {
                if (input.type === 'checkbox') {
                    input.addEventListener('change', calculateROI);
                } else {
                    input.addEventListener('input', calculateROI);
                }
            });

            // Initial calculation
            calculateROI();
        });
    </script>
</body>
</html>